import{_ as S,C as B,T as H,c as j,e as O}from"./groupBy-B5JDjmjc.js";import{C as R,T as E}from"./TimeHeatmapChart-B9v-fgVb.js";import{d as h,f as G,S as L,C as N,r as q}from"./index-9J0OcJMf.js";import{d as w,s as b,Y as M,Z as z,_ as $,L as x,O as g,P as C,U as k,f as T,N as f,F as V,X as A,Q as t,a1 as W,R as c,S as F}from"./index-DfSfAmJg.js";import"./on-popup-reopen-DBlk2QAn.js";import"./interceptor-CR4HCnZu.js";const I=w({components:{ContributionChart:R},props:{id:{type:String,default:"js-contribution"},logs:{type:Array,required:!0}},setup(e){const s=b(()=>S(e.logs,a=>h(a.startTime).dayOfYear())),y=M({contributions:b(()=>{const a=h(e.logs[0].startTime).startOf("year"),p=a.isLeapYear()?366:365,v=a.isoWeekday()%7;return Array.from({length:v}).fill("").map(()=>({date:"",value:-1,items:[]})).concat(Array.from({length:p}).fill("").map((r,o)=>{const i=a.add(o,"day"),_=s.value[o+1]?.length??0,n=s.value[o+1]||[];return{date:i.toISOString(),value:_,items:n}}))})}),u=M({date:"",items:[]});function l({date:a,items:p}){u.date=a,u.items=p}function d(a){return h(a).format("YYYY/MM/DD (ddd)")}return{...z(y),dayDetails:u,formatDate:d,onClick:l}}});function P(e,s,y,u,l,d){const a=g("ContributionChart");return C(),x(a,{id:e.id,key:e.id,contributions:e.contributions,onBlockClick:e.onClick},null,8,["id","contributions","onBlockClick"])}const Q=$(I,[["render",P]]),U=w({components:{TimeHeatmapChart:E},props:{id:{type:String,default:"js-heatmap"},logs:{type:Array,required:!0}},setup(e){const s=b(()=>{const l=S(e.logs,a=>h(a.startTime).weekday()),d=[];return Array.from({length:7}).fill("").forEach((a,p)=>{Array.from({length:24}).fill("").forEach((v,r)=>{const o=l[p]?.filter(_=>h(_.startTime).isSame(h(_.startTime).hour(r),"hour")),i=o?.length??0;d.push({weekday:+p,hour:r,value:i,logs:o})})}),d});function y(l){return h().weekday(l).format("ddd")}function u(l){const d=h().startOf("day");return`${d.hour(l).format("HH:mm")}~${d.hour(l+1).format("HH:mm")}`}return{dataset:s,formatDate:G,formatWeekDay:y,formatHour:u}}});function X(e,s,y,u,l,d){const a=g("TimeHeatmapChart");return C(),x(a,{id:e.id,dataset:e.dataset},null,8,["id","dataset"])}const Z=$(U,[["render",X]]),J=w({components:{VanTabs:j,VanTab:H,VanCell:N,VanCellGroup:B,VanSkeleton:L,SportContributionChart:Q,SportTimeHeatmapChart:Z},setup(){const{state:e,isReady:s}=O(q("mi/sport"),{success:!1,resultMessage:"",resultCode:"",resultException:"",items:[]}),y=b(()=>e.value.items),u=b(()=>{const r=S(y.value,o=>h(o.startTime).year());return Object.keys(r).sort((o,i)=>+o>+i?-1:1).map(o=>({id:+o,logs:r[o]}))});function l(r,o){return h(r).format(o)}function d(r){switch(r){case 1:return"戶外跑";case 6:return"健走";case 9:return"戶外騎乘";case 14:return"游泳";case 16:return"自由訓練";default:return r}}function a(r){const o=r.reduce((D,Y)=>D+=Y.sportTime,0),i=60,_=i*60,n=Math.floor(o%60),m=Math.floor(o/i%60);return{h:Math.floor(o/_),m:`${m}`.padStart(2,"0"),s:`${n}`.padStart(2,"0")}}function p(r){return r.reduce((o,i)=>o+=i.calories,0)}function v(r){const o=Math.floor(r/60),i=r-o*60;return{m:o,s:`${i}`.padStart(2,"0")}}return{isReady:s,arrayByYear:u,logs:y,formatDate:l,formatType:d,formatSportTime:v,getAllSportTime:a,getAllCalories:p}}}),K={class:"max-w-2xl mx-auto"},tt={class:"text-center"},et={class:"mt-3 mb-1"},st={class:"text-center mt-4 text-gray-500"},ot={class:"mb-1"},rt={class:"text-center pl-2 pr-5 border-r w-20"},at={class:"text-xs text-gray-500"},nt={class:"text-gray-700 mb-1"},it={class:"font-bold text-xl"},lt={class:"text-center"},ct={class:"text-xs"},dt={class:"text-xs ml-2"},mt={class:"flex items-center justify-around"},ut={class:"flex flex-col items-center justify-center px-2"},pt={class:"text-center mt-1"},ft={class:"text-2xl font-bold mr-1"},ht={class:"text-2xl font-bold mr-1"},yt={class:"flex flex-col items-center justify-center px-2"},gt={class:"text-center mt-1"},_t={class:"text-2xl font-bold mr-1"},Ct={class:"pt-4"};function Tt(e,s,y,u,l,d){const a=g("SportContributionChart"),p=g("VanCell"),v=g("VanCellGroup"),r=g("VanTab"),o=g("VanTabs"),i=g("SportTimeHeatmapChart"),_=g("VanSkeleton");return C(),k("div",{class:W(e.isReady?"":"py-4")},[T(_,{title:"",row:10,loading:!e.isReady,round:""},{default:f(()=>[T(o,{type:"card","offset-top":5,sticky:""},{default:f(()=>[T(r,{title:"資料"},{default:f(()=>[T(o,{"offset-top":35,"line-height":1,sticky:"",border:""},{default:f(()=>[(C(!0),k(V,null,A(e.arrayByYear,n=>(C(),x(r,{key:n.id,title:`${n.id}`},{default:f(()=>[t("div",K,[T(v,{border:""},{title:f(()=>[t("div",tt,c(n.id),1),t("div",et,[(C(),x(a,{id:`js-contribution-${n.id}`,key:n.id,logs:n.logs},null,8,["id","logs"]))]),t("div",st,[t("div",ot,[s[0]||(s[0]=F(" 累積時數: ",-1)),t("span",null,c(e.getAllSportTime(n.logs).h),1),s[1]||(s[1]=t("span",{class:"ml-1 mr-2"},"時",-1)),t("span",null,c(e.getAllSportTime(n.logs).m),1),s[2]||(s[2]=t("span",{class:"ml-1 mr-2"},"分",-1)),t("span",null,c(e.getAllSportTime(n.logs).s),1),s[3]||(s[3]=t("span",{class:"ml-1 mr-2"},"秒",-1))]),t("div",null,"累積消耗熱量: "+c(e.getAllCalories(n.logs))+" kcal",1)])]),default:f(()=>[(C(!0),k(V,null,A(n.logs,m=>(C(),x(p,{key:m.id,center:"",border:""},{icon:f(()=>[t("div",rt,[t("div",at,c(e.formatDate(m.startTime,"YYYY")),1),t("div",nt,c(e.formatDate(m.startTime,"MMMM")),1),t("div",it,c(e.formatDate(m.startTime,"D")),1)])]),title:f(()=>[t("div",lt,[t("span",ct,c(e.formatType(m.type)),1),t("span",dt,c(e.formatDate(m.startTime,"HH:mm:ss")),1)]),t("div",mt,[t("div",ut,[s[6]||(s[6]=t("div",{class:"flex items-center text-orange-500"},[t("svg",{class:"iconify iconify--mdi mr-1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"1em",height:"1em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},[t("path",{d:"M19.03 7.39l1.42-1.42c-.45-.51-.9-.97-1.41-1.41L17.62 6c-1.55-1.26-3.5-2-5.62-2a9 9 0 0 0 0 18c5 0 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61M13 14h-2V7h2v7m2-13H9v2h6V1z",fill:"currentColor"})]),t("span",null,"時間")],-1)),t("div",pt,[t("span",ft,c(e.formatSportTime(m.sportTime).m),1),s[4]||(s[4]=t("span",{class:"text-gray-500 mr-1"},"m",-1)),t("span",ht,c(e.formatSportTime(m.sportTime).s),1),s[5]||(s[5]=t("span",{class:"text-gray-500 mr-1"},"s",-1))])]),t("div",yt,[s[8]||(s[8]=t("div",{class:"flex items-center text-orange-500"},[t("svg",{class:"iconify iconify--mdi mr-1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"1em",height:"1em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},[t("path",{d:"M17.66 11.2c-.23-.3-.51-.56-.77-.82c-.67-.6-1.43-1.03-2.07-1.66C13.33 7.26 13 4.85 13.95 3c-.95.23-1.78.75-2.49 1.32c-2.59 2.08-3.61 5.75-2.39 8.9c.04.1.08.2.08.33c0 .22-.15.42-.35.5c-.23.1-.47.04-.66-.12a.58.58 0 0 1-.14-.17c-1.13-1.43-1.31-3.48-.55-5.12C5.78 10 4.87 12.3 5 14.47c.06.5.12 1 .29 1.5c.14.6.41 1.2.71 1.73c1.08 1.73 2.95 2.97 4.96 3.22c2.14.27 4.43-.12 6.07-1.6c1.83-1.66 2.47-4.32 1.53-6.6l-.13-.26c-.21-.46-.77-1.26-.77-1.26m-3.16 6.3c-.28.24-.74.5-1.1.6c-1.12.4-2.24-.16-2.9-.82c1.19-.28 1.9-1.16 2.11-2.05c.17-.8-.15-1.46-.28-2.23c-.12-.74-.1-1.37.17-2.06c.19.38.39.76.63 1.06c.77 1 1.98 1.44 2.24 2.8c.04.14.06.28.06.43c.03.82-.33 1.72-.93 2.27z",fill:"currentColor"})]),t("span",null,"熱量")],-1)),t("div",gt,[t("span",_t,c(m.calories),1),s[7]||(s[7]=t("span",{class:"text-gray-500"},"kcal",-1))])])])]),_:2},1024))),128))]),_:2},1024)])]),_:2},1032,["title"]))),128))]),_:1})]),_:1}),T(r,{title:"時間熱圖"},{default:f(()=>[t("div",Ct,[T(i,{logs:e.logs},null,8,["logs"])])]),_:1})]),_:1})]),_:1},8,["loading"])],2)}const Mt=$(J,[["render",Tt]]);export{Mt as default};
